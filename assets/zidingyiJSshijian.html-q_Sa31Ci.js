import{_ as s,o as n,c as a,a as e}from"./app-84lPdggs.js";const p={},t=e(`<h1 id="怎么创建-javascript-自定义事件" tabindex="-1"><a class="header-anchor" href="#怎么创建-javascript-自定义事件" aria-hidden="true">#</a> 怎么创建 JavaScript 自定义事件</h1><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[web前端开发](javascript:void(0);) *2022-05-03 10:48* *发表于上海*
来源：https://blog.webdevsimplified.com/2022-04/js-custom-events/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>你肯定处理过很多的事件监听，比如点击事件或者表单提交。事件监听对许多用例来说很有帮助，但是有时我们需要创建自己的自定义事件来处理复杂的交互。在这片短文中，我将告诉你有关创建自定义事件，侦听自定义事件以及创建双击自定义事件所要了解的内容。</p><h1 id="怎么创建自定义事件" tabindex="-1"><a class="header-anchor" href="#怎么创建自定义事件" aria-hidden="true">#</a> <strong>怎么创建自定义事件</strong></h1><p>创建自定义事件听起来很困难，但是只需要下面简单的一行代码即可。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> myEvent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Event</span><span class="token punctuation">(</span><span class="token string">&#39;myCustomEvent&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>你可以通过事件构造函数创建一个新的 Event 对象。在最基本的形式中，你只需要将一个字符串传递给构造函数，这个字符串就是你定义的事件名称。为了监听这个事件，你可以将该事件监听器添加到你要监听的元素上，如下：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;myCustomEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>最后一步，你需要做的事，触发创建并正在监听的事件。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>document<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>myEvent<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这就需呀 dispatchEvent 函数了。每个元素都有这个方法，你要做的就是将你创建的对象传递给它。</p><p>如果我们将上面讲的组合在一起，我们就得到了一个基本的事件，这个事件在我们的 document 元素触发，相关的事件内容会被打印出来。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">isTrusted</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">bubbles</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cancelBubble</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cancelable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">composed</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">currentTarget</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token literal-property property">defaultPrevented</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">eventPhase</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token punctuation">[</span>document<span class="token punctuation">,</span> window<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">returnValue</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">srcElement</span><span class="token operator">:</span> document<span class="token punctuation">,</span>
  <span class="token literal-property property">target</span><span class="token operator">:</span> documrnt<span class="token punctuation">,</span>
  <span class="token literal-property property">timeStamp</span><span class="token operator">:</span> <span class="token number">54.123231</span><span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;myCustomEvent&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>图中是这个事件对象的最基本形式。它包含大量信息，最重要的部分我这里突出显示了。</p><p>isTrusted 属性仅指该事件是由用户交互触发，还是由自定义 JavaScript 代码触发的。例如，当用户单击按钮时，事件将 isTrusted 设置为 true，而我们自定义的事件会将其设置为 false，因为该事件是由 JavaScript 触发的。</p><p>target 指调用 dispatchEvent 函数的元素。</p><p>type 指事件的名称。</p><h1 id="事件定制" tabindex="-1"><a class="header-anchor" href="#事件定制" aria-hidden="true">#</a> <strong>事件定制</strong></h1><p>你可能注意到了，上面的详情中有属性 bubbles, cancelable 和 composed 属性。这些实际上，在我们创建自定义事件时可以配置的选项。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> myEvent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Event</span><span class="token punctuation">(</span><span class="token string">&#39;myCustomEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">bubbles</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cancelable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">composed</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="冒泡-bubbles" tabindex="-1"><a class="header-anchor" href="#冒泡-bubbles" aria-hidden="true">#</a> <strong>冒泡 bubbles</strong></h2><p>当事件触发后，bubbles 属性决定这个事件是否可以通过 html 进行冒泡。这个值默认为 false，这意味着不可以进行冒泡行为，如果你想事件调用父 HTML 元素，你可以将其设置为 true。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> bubbleEvent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Event</span><span class="token punctuation">(</span><span class="token string">&#39;bubbleEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">bubbles</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> defaultEvent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Event</span><span class="token punctuation">(</span><span class="token string">&#39;defaultEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">bubbles</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;bubbleEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// This will get called since the event will bubble up to the document from the button</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Bubble&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;defaultEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// This never gets called since the event cannot bubble up to the document from the button</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Default&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">)</span>
button<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>bubbleEvent<span class="token punctuation">)</span>
button<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>defaultEvent<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="可取消-cancelable" tabindex="-1"><a class="header-anchor" href="#可取消-cancelable" aria-hidden="true">#</a> <strong>可取消 cancelable</strong></h2><p>cancelable 属性决定事件是否可以通过调用 e.preventDefault() 取消。默认是 false 不可以。如果该属性是 true 值，你可以调用 e.preventDefault() 方法。e.preventDefault() 会将事件 defaultPrevented 属性设置为 true。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> cancelableEvent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Event</span><span class="token punctuation">(</span><span class="token string">&#39;cancelableEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">cancelable</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> defaultEvent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Event</span><span class="token punctuation">(</span><span class="token string">&#39;defaultEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">cancelable</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;cancelableEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>defaultPrevented<span class="token punctuation">)</span> <span class="token comment">// True</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;defaultEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>defaultPrevented<span class="token punctuation">)</span> <span class="token comment">// False</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>cancelableEvent<span class="token punctuation">)</span>
document<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>defaultEvent<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="组合-composed" tabindex="-1"><a class="header-anchor" href="#组合-composed" aria-hidden="true">#</a> <strong>组合 composed</strong></h2><p>composed 属性决定事件是否可以通过影子 dom 向上传播。默认值是 false。该属性仅在你使用自定 HTML 元素和影子 DOM 的时候才适用，它所做的是允许事件在影子 DOM 外面传播。</p><p>如果你想在影子 DOM 中触发的事件可以在影子 DOM 外被捕捉到，就将其设置为 true。</p><p><strong><em>没听懂没关系，后面学着学着就懂了</em></strong></p><h2 id="给事件传递自定义数据" tabindex="-1"><a class="header-anchor" href="#给事件传递自定义数据" aria-hidden="true">#</a> <strong>给事件传递自定义数据</strong></h2><p>当你使用自定事件时，你希望自定义的数据传递给你的事件。使用 new Event 构造函数是不可能的，这也就是为什么会有第二种创建事件的方法。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> myEvent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CustomEvent</span><span class="token punctuation">(</span><span class="token string">&#39;myEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">detail</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">hello</span><span class="token operator">:</span> <span class="token string">&#39;World&#39;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>CustomEvent 构造函数取代 Event 构造函数。这与 new Event 的工作方式相同，但你可以将 detail 属性以及 bubbles，cancelable 和 composed 属性一起传递给第二个参数。detail 属性中你设置的内容都会传递给事件监听器。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> mtEvent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CustomEvent</span><span class="token punctuation">(</span><span class="token string">&#39;myEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">detail</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">hello</span><span class="token operator">:</span> <span class="token string">&#39;World&#39;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;myEvent&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>detail<span class="token punctuation">)</span> <span class="token comment">// { hello: &quot;World&quot; }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

document<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>myEvent<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="命名约定" tabindex="-1"><a class="header-anchor" href="#命名约定" aria-hidden="true">#</a> <strong>命名约定</strong></h1><p>在我们讲自定义双击事件的例子前，我想先讲讲命名约定。你可以为自定义事件命名任何你想要的名字，但是还是遵循命名约定，以更方便使用自己的代码。最普遍的命名约定事件，是为事件添加 custom: 前缀。</p><p>custom: 以区分自定义事件和本身的事件，而且，如果 JavaScript 添加与你的事件同名的新事件，它还可以确保你的代码不会中断。</p><p>举个例子，如果 JavaScript 添加了一个名为 doubleclick 事件，然后你已经在时候 doubleclick 自定义事件了，那么你会遇到问题，因为你自定义代码将触发该事件，并且浏览器也会尝试触发它自己的副本。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// Always use some form of naming convention</span>
cionst myEvent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Event</span><span class="token punctuation">(</span><span class="token string">&quot;custom:doubleClick&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="双击事件" tabindex="-1"><a class="header-anchor" href="#双击事件" aria-hidden="true">#</a> <strong>双击事件</strong></h1><p>在这个例子中，我们将创建一个双击的事件，只要你在短时间内单击一个元素，就会触发该事件。该事件还会将按钮单击之间的总时间作为自定义数据传递。</p><p>首先，我们需要创建一个正常的单击事件监听器来确保是否有双击。</p><pre><section class="code-snippet__fix code-snippet__js"><pre class="code-snippet__js" data-lang="typescript"><code><span class="code-snippet_outer"><span class="code-snippet__keyword">const</span> button = <span class="code-snippet__built_in">document</span>.querySelector(<span class="code-snippet__string">&quot;button&quot;</span>)</span></code><code><span class="code-snippet_outer"><br></span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">const</span> MAX_DOUBLE_CLICK_TIME = <span class="code-snippet__number">500</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">let</span> lastClick = <span class="code-snippet__number">0</span></span></code><code><span class="code-snippet_outer">button.addEventListener(<span class="code-snippet__string">&quot;click&quot;</span>, <span class="code-snippet__function"><span class="code-snippet__params">e</span> =&gt;</span> {</span></code><code><span class="code-snippet_outer">  <span class="code-snippet__keyword">const</span> timeBetweenClicks = e.timeStamp - lastClick</span></code><code><span class="code-snippet_outer">  <span class="code-snippet__keyword">if</span> (timeBetweenClicks &gt; MAX_DOUBLE_CLICK_TIME) {</span></code><code><span class="code-snippet_outer">    lastClick = e.timeStamp</span></code><code><span class="code-snippet_outer">    <span class="code-snippet__keyword">return</span></span></code><code><span class="code-snippet_outer">  }</span></code><code><span class="code-snippet_outer"><br></span></code><code><span class="code-snippet_outer">  <span class="code-snippet__comment">// <span class="code-snippet__doctag">TODO:</span> Double click happened. Trigger custom event.</span></span></code><code><span class="code-snippet_outer">  lastClick = <span class="code-snippet__number">0</span></span></code><code><span class="code-snippet_outer">})</span></code></pre></section></pre><p>上面的代码使用 timeStamp 属性来确保按钮上单击事件之间的时间。如果点击之间的时间超过 500 毫秒。</p><p>则会立刻返回并更新 lastClick 的值。一旦我们在 500 毫秒内点击了两次，我们将通过 if 检查并触发我们的双击事件。为此，我们需要创建我们的事件并调用它。</p><pre><section class="code-snippet__fix code-snippet__js"><pre class="code-snippet__js" data-lang="typescript"><code><span class="code-snippet_outer"><span class="code-snippet__keyword">const</span> button = <span class="code-snippet__built_in">document</span>.querySelector(<span class="code-snippet__string">&quot;button&quot;</span>)</span></code><code><span class="code-snippet_outer"><br></span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">const</span> MAX_DOUBLE_CLICK_TIME = <span class="code-snippet__number">500</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">let</span> lastClick = <span class="code-snippet__number">0</span></span></code><code><span class="code-snippet_outer">button.addEventListener(<span class="code-snippet__string">&quot;click&quot;</span>, <span class="code-snippet__function"><span class="code-snippet__params">e</span> =&gt;</span> {</span></code><code><span class="code-snippet_outer">  <span class="code-snippet__keyword">const</span> timeBetweenClicks = e.timeStamp - lastClick</span></code><code><span class="code-snippet_outer">  <span class="code-snippet__keyword">if</span> (timeBetweenClicks &gt; MAX_DOUBLE_CLICK_TIME) {</span></code><code><span class="code-snippet_outer">    lastClick = e.timeStamp</span></code><code><span class="code-snippet_outer">    <span class="code-snippet__keyword">return</span></span></code><code><span class="code-snippet_outer">  }</span></code><code><span class="code-snippet_outer"><br></span></code><code><span class="code-snippet_outer">  <span class="code-snippet__comment">// <span class="code-snippet__doctag">TODO:</span> Double click happened. Trigger custom event.</span></span></code><code><span class="code-snippet_outer">  lastClick = <span class="code-snippet__number">0</span></span></code><code><span class="code-snippet_outer">})</span></code></pre></section></pre><p>对于我们自定义的事件，我们将所有选项都设置为 true，因为默认情况下，单击事件将所有这些属性设置为 true，而且我们希望双击的行为类似于正常的单击。</p><p>我们也将 timeBetweenClicks 传递到 detail 选项中。</p><p>最后，我们在事件的目标上调度事件，这里是按钮元素。我们剩下要做的最后一件事就是监听事件。</p><pre><section class="code-snippet__fix code-snippet__js"><pre class="code-snippet__js" data-lang="typescript"><code><span class="code-snippet_outer">onst button = <span class="code-snippet__built_in">document</span>.querySelector(<span class="code-snippet__string">&quot;button&quot;</span>)</span></code><code><span class="code-snippet_outer"><br></span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">const</span> MAX_DOUBLE_CLICK_TIME = <span class="code-snippet__number">500</span></span></code><code><span class="code-snippet_outer"><span class="code-snippet__keyword">let</span> lastClick = <span class="code-snippet__number">0</span></span></code><code><span class="code-snippet_outer">button.addEventListener(<span class="code-snippet__string">&quot;click&quot;</span>, <span class="code-snippet__function"><span class="code-snippet__params">e</span> =&gt;</span> {</span></code><code><span class="code-snippet_outer">  <span class="code-snippet__keyword">const</span> timeBetweenClicks = e.timeStamp - lastClick</span></code><code><span class="code-snippet_outer">  <span class="code-snippet__keyword">if</span> (timeBetweenClicks &gt; MAX_DOUBLE_CLICK_TIME) {</span></code><code><span class="code-snippet_outer">    lastClick = e.timeStamp</span></code><code><span class="code-snippet_outer">    <span class="code-snippet__keyword">return</span></span></code><code><span class="code-snippet_outer">  }</span></code><code><span class="code-snippet_outer"><br></span></code><code><span class="code-snippet_outer">  <span class="code-snippet__keyword">const</span> doubleClickEvent = <span class="code-snippet__keyword">new</span> CustomEvent(<span class="code-snippet__string">&quot;custom:doubleClick&quot;</span>, {</span></code><code><span class="code-snippet_outer">    bubbles: <span class="code-snippet__literal">true</span>,</span></code><code><span class="code-snippet_outer">    cancelable: <span class="code-snippet__literal">true</span>,</span></code><code><span class="code-snippet_outer">    composed: <span class="code-snippet__literal">true</span>,</span></code><code><span class="code-snippet_outer">    detail: { timeBetweenClicks },</span></code><code><span class="code-snippet_outer">  })</span></code><code><span class="code-snippet_outer">  e.target.dispatchEvent(doubleClickEvent)</span></code><code><span class="code-snippet_outer">  lastClick = <span class="code-snippet__number">0</span></span></code><code><span class="code-snippet_outer">})</span></code></pre></section></pre><p>我们刚刚向按钮田间了一个简单的事件监听器，它将打印出 Double Click 之间的时间。</p><h1 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> <strong>总结</strong></h1><p>自定义事件是 JavaScript 中处理手势和双击事件的好方案，最重要的是，他们非常容易实现和使用。</p>`,54),o=[t];function c(l,i){return n(),a("div",null,o)}const r=s(p,[["render",c],["__file","zidingyiJSshijian.html.vue"]]);export{r as default};
