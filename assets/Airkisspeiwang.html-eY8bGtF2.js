import{_ as p,r as t,o as i,c as o,b as s,d as n,e,a as r}from"./app-a8d-X_GH.js";const c="/assets/1679033868855-ehuEK-Bw.png",l="/assets/1679034389717-8dGN0P5i.png",u={},d={id:"微信小程序-airkiss-配网-微信硬件平台-qq-com",tabindex:"-1"},k=s("a",{class:"header-anchor",href:"#微信小程序-airkiss-配网-微信硬件平台-qq-com","aria-hidden":"true"},"#",-1),v={href:"https://iot.weixin.qq.com/wiki/new/index.html?page=4-1-1",target:"_blank",rel:"noopener noreferrer"},m={href:"https://mp.weixin.qq.com/wxopen/pluginbasicprofile?action=intro&appid=wx610ea582556c983e&token=2125284915&lang=zh_CN",target:"_blank",rel:"noopener noreferrer"},h=s("li",null,[s("img",{src:c,alt:"1679033868855"})],-1),b=r(`<p>AirKiss是微信硬件平台为Wi-Fi设备提供的微信配网、局域网发现和局域网通讯的技术。开发者若要实现通过微信客户端对Wi-Fi设备配网、通过微信客户端在局域网发现Wi-Fi设备，或者把微信客户端内的音乐、图片、文件等消息通过局域网发送至Wi-Fi设备。</p><p>设备进入 Wi-Fi 混杂模式（promiscuous mode）以监听捕获周围的 Wi-Fi 报文。由于设备暂未联网，且 Wi-Fi 网络的数据帧已通过加密，设备无法获取 payload 的内容，但可以获取报文的某些特征数据，例如每个报文的长度，同时对于某些数据帧；例如 UDP 的广播包或多播包，其报文的帧头结构比较固定，较容易识别。</p><p>此时在手机 App 或者小程序侧，即可通过发送 UDP 的广播包或多播包，并利用报文的特征，例如长度变化进行编码。</p><p>将目标 Wi-Fi 路由器的 SSID/PSW 字符以约定的编码方式发送出去，设备端在捕获到 UDP 报文后，按约定的方式进行解码，即可得到目标 Wi-Fi 路由器的相关信息并进行联网。</p><h2 id="使用方式" tabindex="-1"><a class="header-anchor" href="#使用方式" aria-hidden="true">#</a> 使用方式</h2><ol><li>添加插件</li><li>在对应页面引入插件 <strong>requirePlugin</strong>(<strong>&#39;airkiss&#39;</strong>)</li><li>调用api进行配网 airkiss.startAirkiss()</li></ol><h2 id="添加插件" tabindex="-1"><a class="header-anchor" href="#添加插件" aria-hidden="true">#</a> 添加插件</h2><p>打开 app.js 文件添加代码</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;airkiss&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.1.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;provider&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wx610ea582556c983e&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>根据提示添加插件，如果已经在小程序后台添加则不会有提示</p><p><img src="`+l+`" alt="1679034389717"></p><h2 id="在要进行配网功能的页面引入插件" tabindex="-1"><a class="header-anchor" href="#在要进行配网功能的页面引入插件" aria-hidden="true">#</a> 在要进行配网功能的页面引入插件</h2><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> airkiss <span class="token operator">=</span> <span class="token function">requirePlugin</span><span class="token punctuation">(</span><span class="token string">&#39;airkiss&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//获取版本</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> airkiss<span class="token punctuation">.</span>version<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="使用-api-进行配网" tabindex="-1"><a class="header-anchor" href="#使用-api-进行配网" aria-hidden="true">#</a> 使用 api 进行配网</h2><h3 id="airkiss-startairkiss-ssid-password-funtion" tabindex="-1"><a class="header-anchor" href="#airkiss-startairkiss-ssid-password-funtion" aria-hidden="true">#</a> airkiss.startAirkiss(ssid,password,funtion())</h3><p>开始配置，需要入参路由器的SSID、密码以及回调函数，出参说明见示例。</p><p>Note：请自行处理是否为2.4G频段路由器，以及密码是否正确。</p><h3 id="airkiss-stopairkiss" tabindex="-1"><a class="header-anchor" href="#airkiss-stopairkiss" aria-hidden="true">#</a> airkiss.stopAirkiss()</h3><p>停止配置，释放配网线程的内存。</p><p>Note：建议在建议在页面 unload 等生命周期里面调用。</p><h3 id="airkiss-version" tabindex="-1"><a class="header-anchor" href="#airkiss-version" aria-hidden="true">#</a> airkiss.version</h3><p>获取版本</p><h2 id="代码参考" tabindex="-1"><a class="header-anchor" href="#代码参考" aria-hidden="true">#</a> 代码参考</h2><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> airkiss <span class="token operator">=</span> <span class="token function">requirePlugin</span><span class="token punctuation">(</span><span class="token string">&#39;hello-plugin&#39;</span><span class="token punctuation">)</span>

<span class="token comment">//这里最好加微信小程序判断账号密码是否为空，以及其长度和是否为5G频段</span>
airkiss<span class="token punctuation">.</span><span class="token function">startAirkiss</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>ssid<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>password<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
      wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;初始化失败&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">content</span><span class="token operator">:</span> res<span class="token punctuation">.</span>result<span class="token punctuation">,</span>
        <span class="token literal-property property">showCancel</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">confirmText</span><span class="token operator">:</span> <span class="token string">&#39;收到&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">break</span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
      wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;配网成功&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">&#39;设备IP：&#39;</span> <span class="token operator">+</span> res<span class="token punctuation">.</span>ip <span class="token operator">+</span> <span class="token string">&#39;\\r\\n 设备Mac：&#39;</span> <span class="token operator">+</span> res<span class="token punctuation">.</span>bssid<span class="token punctuation">,</span>
        <span class="token literal-property property">showCancel</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">confirmText</span><span class="token operator">:</span> <span class="token string">&#39;好的&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">break</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
      wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&#39;配网失败&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">&#39;请检查密码是否正确&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">showCancel</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">confirmText</span><span class="token operator">:</span> <span class="token string">&#39;收到&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">break</span>

    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">break</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//停止配网，建议在页面 unload 等生命周期里面调用，释放线程</span>
airkiss<span class="token punctuation">.</span><span class="token function">stopAirkiss</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,24);function g(y,f){const a=t("ExternalLinkIcon");return i(),o("div",null,[s("h1",d,[k,n(" 微信小程序 Airkiss 配网 ["),s("a",v,[n("微信硬件平台 (qq.com)"),e(a)]),n("]")]),s("ul",null,[s("li",null,[n("小程序使用Airkiss配网可考虑使用微信插件来进行实现 WeChatAirkiss ["),s("a",m,[n("AiThinkerAirkissforWXMini"),e(a)]),n("]")]),h]),b])}const _=p(u,[["render",g],["__file","Airkisspeiwang.html.vue"]]);export{_ as default};
